# 智能骑行天气助手

基于天气条件为你的通勤骑行提供智能建议的Python应用程序。

## ✨ 功能特点

- 🌤️ **实时天气数据**: 使用和风天气API获取准确的天气信息
- 🏙️ **城市智能识别**: 自动将城市名称转换为精确的地理位置
- 🚴‍♂️ **智能骑行建议**: 基于温度、风速、降水等多维度分析
- ⚙️ **个性化设置**: 支持自定义温度、风速、降水偏好
- 🏠➡️🏢 **通勤类型识别**: 自动判断同城或跨城通勤并给出针对性建议

## 🚀 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 获取和风天气API密钥
1. 访问 [和风天气开发平台](https://dev.qweather.com/)
2. 注册账号并登录
3. 创建应用获取API密钥（免费版每天1000次调用）

### 3. 配置文件
复制 `config.json.example` 为 `config.json` 并填入你的信息：

```json
{
  "home_city": "北京市",
  "work_city": "上海市",
  "api_key": "你的和风天气API密钥",
  "preferences": {
    "min_temp": 5,        // 最低温度（摄氏度）
    "max_temp": 30,       // 最高温度（摄氏度）
    "max_wind_speed": 10, // 最大风速（m/s）
    "allow_rain": false   // 是否允许雨天骑行
  }
}
```

### 4. 运行程序
```bash
python main.py
```

## 📋 使用示例

```bash
🏠 家庭城市: 鞍山市
🏢 工作城市: 鞍山市
🚴 通勤类型: 同城通勤

📡 正在获取 鞍山市 的天气信息...
✅ 天气数据获取成功

🌤️ 天气概况:
温度: 24.0°C | 风速: 3.1m/s | 天气: 雾 | 湿度: 86%

✅ 今天适合骑行!

💡 通勤建议:
📍 家庭地址 (鞍山市):
温度: 24.0°C | 风速: 3.1m/s | 天气: 雾 | 湿度: 86%

🏠➡️🏢 同城通勤建议:
✅ 天气不错，适合骑行！当前温度 24.0°C，风速 3.1 m/s，天气状况：雾
💡 建议: 天气条件良好，适合骑行通勤！记得做好防护措施。
```

## 🔧 技术架构

### 核心模块
- **main.py**: 主程序入口，协调各模块工作
- **weather.py**: 天气数据获取和处理
- **core.py**: 核心逻辑，包括骑行适宜性判断和建议生成

### API调用流程
1. **城市ID查询**: 通过和风天气GeoAPI将城市名称转换为城市ID
2. **天气数据获取**: 使用城市ID调用实时天气API
3. **数据标准化**: 将和风天气数据转换为统一格式
4. **智能分析**: 基于天气数据和用户偏好生成建议

### 支持的天气条件
- ✅ 温度范围检查
- ✅ 风速限制
- ✅ 降水检测（雨、雪、雾等）
- ✅ 湿度和能见度分析

## 📝 配置说明

### 城市名称格式
- 推荐使用标准城市名称：`北京市`、`上海市`、`广州市`
- 重名城市可加省份：`西安,陕西`
- 避免过于详细的地址信息

### 偏好设置
- `min_temp`: 最低可接受温度（°C）
- `max_temp`: 最高可接受温度（°C）
- `max_wind_speed`: 最大可接受风速（m/s）
- `allow_rain`: 是否允许雨雪天气骑行

## 🔍 故障排除

### 常见问题
1. **城市查询失败**: 检查城市名称拼写，使用标准名称
2. **API错误**: 确认API密钥有效，检查调用次数限制
3. **网络超时**: 检查网络连接，稍后重试

### 调试技巧
- 查看详细的错误输出信息
- 验证API密钥在和风天气控制台中的状态
- 尝试不同格式的城市名称

## 📚 更新历史

- **v2.0**: 完全移除坐标依赖，直接使用城市名称
- **v1.1**: 移除地理编码功能，使用经纬度配置
- **v1.0**: 初始版本，支持地址自动编码

详细迁移指南请参考 [MIGRATION_GUIDE.md](MIGRATION_GUIDE.md)

## 📄 许可证

本项目仅供学习和个人使用。使用和风天气API请遵守其服务条款。